{{ range . }}
<div class="link-item bg-white dark:bg-gray-800 rounded-lg shadow hover:shadow-md transition-all duration-200 overflow-hidden mb-5" id="link-{{.ID}}">
    <div class="p-5">
        <div class="flex flex-col md:flex-row">
            {{ if .ImageUrl.Valid }}
            <div class="md:w-20 md:h-20 w-full h-40 mb-4 md:mb-0 md:mr-4 flex-shrink-0">
                <img src="{{.ImageUrl.String}}" alt="Link preview" class="w-full h-full object-cover rounded" onerror="this.style.display='none'">
            </div>
            {{ else }}
            <div class="md:w-20 md:h-20 w-full h-40 mb-4 md:mb-0 md:mr-4 flex-shrink-0 bg-gray-100 dark:bg-gray-700 rounded flex items-center justify-center">
                <svg class="w-8 h-8 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 3 3 0 004.242 4.242 1 1 0 001.414-1.414 1 1 0 010-1.414l3-3a2 2 0 00-2.828-2.828 1 1 0 01-1.414-1.414z" clip-rule="evenodd"></path>
                    <path fill-rule="evenodd" d="M5.172 12.586a2 2 0 010 2.828l-3 3a2 2 0 01-2.828-2.828l3-3a2 2 0 012.828 0zm6.828-6.828a2 2 0 010-2.828l3-3a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0z" clip-rule="evenodd"></path>
                </svg>
            </div>
            {{ end }}
            
            <div class="flex-1 min-w-0">
                <a href="/view-link.html?id={{.ID}}" class="text-lg font-semibold text-blue-600 dark:text-blue-400 hover:underline block mb-2">{{ if .Title.Valid }}{{.Title.String}}{{ else }}{{.Url}}{{ end }}</a>
                <div class="text-gray-600 dark:text-gray-300 text-sm markdown-content mb-3">
                    {{.Commentary}}
                </div>
                <div class="text-xs text-gray-500 dark:text-gray-400 truncate">
                    {{.Url}}
                </div>
            </div>
        </div>
        
        <div class="mt-4 flex space-x-2">
            <a href="/view-link.html?id={{.ID}}" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors">
                View
            </a>
            <button hx-put="/.netlify/functions/api?id={{.ID}}" hx-target="#link-{{.ID}}" hx-swap="outerHTML" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded text-sm font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                Edit
            </button>
            <button hx-delete="/.netlify/functions/api?id={{.ID}}" hx-target="#link-{{.ID}}" hx-swap="outerHTML" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded text-sm font-medium hover:bg-red-100 dark:hover:bg-red-900/50 transition-colors">
                Delete
            </button>
        </div>
    </div>
</div>
{{ end }}